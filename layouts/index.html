{{ define "main" }}

<div class="
    h-screen w-full overflow-y-scroll snap-y snap-mandatory scroll-smooth no-scrollbar
    md:h-auto md:overflow-visible md:snap-none md:pt-24 md:pb-12 md:max-w-7xl md:mx-auto md:px-6
">

    <header class="hidden md:flex items-end justify-between mb-10 border-b border-gray-200 pb-6">
        <div>
            <h1 class="text-5xl font-black text-text-main tracking-tight mb-2">In Primo Piano</h1>
            <p class="text-gray-500">Le notizie pi√π importanti selezionate per te.</p>
        </div>
        <span class="text-sm font-medium text-brand uppercase tracking-wider">Aggiornato oggi</span>
    </header>

    <div class="md:grid md:grid-cols-2 lg:grid-cols-3 md:gap-8 lg:gap-10">

        {{ range $index, $element := where .Site.RegularPages "Section" "posts" }}
        
        <article class="
            group relative w-full h-screen snap-start shrink-0 flex flex-col justify-end
            md:h-auto md:snap-align-none md:block md:bg-transparent md:justify-start
        ">
            
            <div class="absolute inset-0 z-0 overflow-hidden md:relative md:aspect-[4/3] md:rounded-2xl md:shadow-lg">
                
                {{/* Cerchiamo l'immagine nelle risorse della pagina ($element) */}}
                {{ $imgResource := $element.Resources.GetMatch "*{jpg,jpeg,png,webp}" }}
                
                {{ with $imgResource }}
                    {{ $mobileImg := .Fill "800x1200 webp center" }}
                    {{ $desktopImg := .Fill "800x600 webp center" }}
                    
                    {{ if eq $index 0 }}
                        <img src="{{ $mobileImg.RelPermalink }}" 
                             class="md:hidden w-full h-full object-cover" 
                             alt="{{ $element.Title }}"
                             fetchpriority="high"
                             loading="eager">
                        
                        <img src="{{ $desktopImg.RelPermalink }}" 
                             class="hidden md:block w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" 
                             alt="{{ $element.Title }}"
                             fetchpriority="high"
                             loading="eager">
                    
                    {{ else }}
                        <img src="{{ $mobileImg.RelPermalink }}" 
                             class="md:hidden w-full h-full object-cover" 
                             alt="{{ $element.Title }}"
                             loading="lazy">
                        
                        <img src="{{ $desktopImg.RelPermalink }}" 
                             class="hidden md:block w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" 
                             alt="{{ $element.Title }}"
                             loading="lazy">
                    {{ end }}

                {{ else }}
                    <div class="w-full h-full bg-slate-200 flex items-center justify-center text-slate-400">No Image</div>
                {{ end }}

                <div class="absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-black/90 md:hidden"></div>
                <div class="hidden md:block absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300"></div>
            </div>

            <div class="relative z-10 p-8 pb-24 md:p-0 md:mt-6">
                
                <div class="flex items-center gap-3 mb-3">
                    <span class="px-3 py-1 text-[10px] font-bold uppercase tracking-widest bg-brand text-white rounded-full shadow-lg md:shadow-none">
                        {{ with $element.Params.categories }}{{ index . 0 }}{{ else }}News{{ end }}
                    </span>
                    <span class="text-xs font-medium text-gray-300 md:text-gray-500 uppercase">
                        {{ $element.Date.Format "02 Gen 2006" }}
                    </span>
                </div>

                <h2 class="text-3xl md:text-2xl font-black leading-tight mb-3 text-white md:text-text-main drop-shadow-md md:drop-shadow-none group-hover:text-brand transition-colors">
                    <a href="{{ $element.RelPermalink }}">
                        {{ $element.Title }}
                    </a>
                </h2>

                <p class="text-gray-200 md:text-text-body text-sm md:text-base leading-relaxed line-clamp-3 mb-6 md:line-clamp-3">
                    {{ $element.Summary }}
                </p>

                <a href="{{ $element.RelPermalink }}" class="hidden md:inline-flex items-center text-sm font-bold text-brand hover:text-brand-dark uppercase tracking-wide">
                    Leggi l'articolo 
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 ml-1">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
                    </svg>
                </a>
            </div>
            
            <a href="{{ $element.RelPermalink }}" class="absolute inset-0 z-20 md:hidden" aria-label="Leggi articolo"></a>

        </article>
        {{ end }}

    </div>
</div>
{{ end }}